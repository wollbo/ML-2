%% modify ICMevaluate and energy to take greyscale vector